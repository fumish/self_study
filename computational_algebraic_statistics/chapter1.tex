% \documentclass[dvipdfmx, 11pt]{beamer}
\documentclass[aspectratio=169, dvipdfmx, 11pt]{beamer} % aspectratio=43, 149, 169
\usepackage{here, amsmath, latexsym, amssymb, bm, ascmac, mathtools, multicol, tcolorbox, subfig}
\def\proofname{\textbf{証明}}

%デザインの選択(省略可)
\usetheme{Luebeck}
%カラーテーマの選択(省略可)
\usecolortheme{orchid}
%フォントテーマの選択(省略可)
\usefonttheme{professionalfonts}
%フレーム内のテーマの選択(省略可)
\useinnertheme{circles}
%フレーム外側のテーマの選択(省略可)
\useoutertheme{infolines}
%しおりの文字化け解消
\usepackage{atbegshi}
\ifnum 42146=\euc"A4A2
\AtBeginShipoutFirst{\special{pdf:tounicode EUC-UCS2}}
\else
\AtBeginShipoutFirst{\special{pdf:tounicode 90ms-RKSJ-UCS2}}
\fi
%ナビゲーションバー非表示
\setbeamertemplate{navigation symbols}{}
%既定をゴシック体に
\renewcommand{\kanjifamilydefault}{\gtdefault}
%タイトル色
\setbeamercolor{title}{fg=structure, bg=}
%フレームタイトル色
\setbeamercolor{frametitle}{fg=structure, bg=}
%スライド番号のみ表示
%\setbeamertemplate{footline}[frame number]
%itemize
\setbeamertemplate{itemize item}{\small\raise0.5pt\hbox{$\bullet$}}
\setbeamertemplate{itemize subitem}{\tiny\raise1.5pt\hbox{$\blacktriangleright$}}
\setbeamertemplate{itemize subsubitem}{\tiny\raise1.5pt\hbox{$\bigstar$}}
% color
\newcommand{\red}[1]{\textcolor{red}{#1}}
\newcommand{\green}[1]{\textcolor{green!40!black}{#1}}
\newcommand{\blue}[1]{\textcolor{blue!80!black}{#1}}

\title[Short title]{計算代数統計}
\author[著者略称]{中村 文士}
\date{\today}

\begin{document}
\maketitle

\begin{frame}{目次}
	\tableofcontents
\end{frame}

\section{初めに}
\begin{frame}{目次}
	\tableofcontents[currentsection]
\end{frame}

\begin{frame}{進め方}
	\begin{itemize}
		\item 計算代数統計の本を読む形で進めていって、不明点があれば、この資料の中で導出していきます。
		\item この本は、線形代数や微積の知識すらなくとも理解できるように書かれていると思うので、他の知識の前提がなく理解できるかと思います。
		\item 一通り本の導出部分も追ったつもりですが、証明は説明できるほど理解できていないと思うので、適宜ご指摘頂ければと思います。
	\end{itemize}
\end{frame}

\begin{frame}{グレブナー基底でできる事の理解}
	今回読む本や論文、雑誌などを見て、どういった応用があるか列挙しています。
	\begin{itemize}
		\item 多項式の連立方程式(線形でなく、$x^n$などの項も含む)を簡単にする時に使える
		\item 実験計画法の考えるべき入力の組み合わせを列挙できる
		\item 制御の問題で複数の多項式制約が与えられたとき、それを簡単にする時に使える
		\item 整数格子状の三角形分割で使える(数理科学)
		\item マルコフ基底というものを考える時に使う?(数理科学, Algebraic Statistics)
		\item transfomerを使ったある問題で使える, IBIS2023の発表にあった
	\end{itemize}
\end{frame}

\section{グレブナー基底入門}
\begin{frame}{目次}
	\tableofcontents[currentsection]
\end{frame}

\subsection{連立方程式}
\begin{frame}{目次}
	\tableofcontents[currentsubsection]
\end{frame}

\input{subsec11.tex}

% \begin{frame}{線形な連立方程式}
% 以下の問題をまず考える
% \begin{equation}
% \left\{
%    \begin{aligned}
%    & x+2y-z=2 \\
%    & x+y-4z=3 \\
%    & x+3y+3z=0
%    \end{aligned}
% \right.
% \end{equation}
% これは、連立1次方程式なので、線形代数で学ぶ手法を使えば良い
% \end{frame}
%
% \begin{frame}
% 次に、以下の問題も考えてみる
% \begin{equation}
% \left\{
%    \begin{aligned}
%    & x^2+y^2+4z^2=81 \\
%    & x-y+z^2=13 \\
%    & xz-2y=18
%    \end{aligned}
% \right.
% \end{equation}
% これは、第2式の2倍を第3式から引いてyを消去し、$xz-2x-2z^2=-8$を得て、この因数分解$(z-2)(x-2z-4)=0$を行うことで、計算ができる。
% \end{frame}
%
% \begin{frame}
% 次の問題は少し難しい
% \begin{equation}
% \left\{
%    \begin{aligned}
%    & x^2+y^2+4z^2=90 \\
%    & x-y+z=12 \\
%    & xz-3y=28
%    \end{aligned}
% \right.
% \end{equation}
% これは、同じような因数分解ができない。
% グレブナー基底の計算のような方法で解いてみようと思ったが、教科書と同じ式導出になりそうなので、教科書で説明
% \end{frame}
%
% \begin{frame} {注意点}
%
% \begin{itemize}
% \item 先ほどの手順はグレブナー基底の計算アルゴリズムになっていることが、後の章で分かる。
% \item グレブナー基底は、各単項式(定義はいずれ出てくる)の順序を与えると得られるもので、今回の手順は、$x \succ y \succ z$で純辞書式順序という順序を用いた場合の結果になっている
% \item 最終的に得られた連立方程式の形式は$z$だけの式だった。これは偶然ではなく、消去定理の結果から、純辞書式順序を用いると、連立方程式のうちの一つが一つの変数の方程式になるためである(これはすごいと思った)。
% \end{itemize}
% \end{frame}
%
% \begin{frame} {実演}
% ここまでの式のグレブナー基底をPython求めてみる: \\
% Pythonでグレブナー基底を使う方法に例えばsympyがあるので、それを簡単に紹介する
% \end{frame}

\subsection{多項式環のイデアル}
\begin{frame}{目次}
	\tableofcontents[currentsubsection]
\end{frame}

\input{subsec12.tex}

%\begin{frame}{多項式環のイデアル}
%%% ざっと資料を作ってみて、この節の要約をここに記述する %%%
%\end{frame}

%\begin{frame} {いくつかの概念の定義}
%いくつかの概念を定義する
%\begin{itemize}
%\item 単項式: $\prod_{i=1}^n x_i^{a_i} = x_1^{a_1} x_2^{a_2} \cdots x_n^{a_n}$, 各$a_i$は非負整数
%\item 単項式の次数: $\sum_{i=1}^n a_i$
%\item 多項式: 変数$x_1,\ldots, x_n$の有限個の項の和
%\item 多項式の次数: 多項式の単項式$f$の次数の中で最大のもの. $deg(f)$と表記する
%\end{itemize}
%
%※ 負の整数も含んだ多項式はローラン多項式という。この本では取り扱わないが、発展的な話題として存在しているようです。
%\end{frame}
%
%\begin{frame} {定義したものの例}
%\begin{equation*}
%f = -5 x_1^2 x_2 x_3^2 + \frac{2}{3} x_2 x_4^3 x_5^2-x_3^3-7
%\end{equation*}
%を考える。この場合、単項式は
%\begin{itemize}
%\item $-5x_1^2x_2x_3^2 $
%\item $\frac{2}{3}x_2x_4^3 x_5^2$
%\item $-x_3^3$
%\item $-7$
%\end{itemize}
%であり、$deg(f)=6$である。 \\
%$-7$は、係数が$-7$で$1$の単項式であり、各変数の次数が0なので次数$0$の単項式を表す。
%\end{frame}
%
%\begin{frame} {多項式環}
%$K$を$\mathbb{Q}$, $\mathbb{R}$, $\mathbb{C}$として用いる. \\
%　→ 有理数, 複素数, 実数は零割り以外の四則演算ができて、そういった集合を体と呼ぶ. \\
%$K$のいずれかを係数とした$x_1,\ldots,x_n$の多項式の集合を$K[x_1,\ldots,x_n]$で定義する.\\
%\begin{block}{コメント}
%本を読んだとき$x_1,\ldots,x_n$が何の集合か不明に感じましたが、
%不定元と呼ばれるもので、$K$上の元の代入はできるが、$K$上の元である必要はないもののようです。
%\end{block}
%
%$K[x_1,\ldots,x_n]$の2つの元$f,g$に対して加減算$f+g$, $f-g$、積$fg$は$K[x_1,\ldots,x_n]$の元であるが、商$f/g$は多項式とは限らないため、$K[x_1,\ldots,x_n]$の元とはいえない。このように加減算と積について閉じている集合を環という。\\
%$K[x_1,\ldots,x_n]$は多項式の環なので、多項式環と呼ぶ。
%
%\end{frame}
%
%\begin{frame} {アフィン多様体}
%イデアルを考える動機付けを行うため、まずアフィン多様体を定義する: \\
%$K[x_1,\ldots,x_n]$の$r$個の元による連立方程式を考える;
%\begin{equation}
%\left\{
%   \begin{aligned}
%   & f_1(x_1,\ldots,x_n) = 0 \\
%   & f_2(x_1,\ldots,x_n) = 0 \\
%   & \cdots \\
%   & f_r(x_1,\ldots,x_n) = 0
%   \end{aligned}
%\right.
%\end{equation}
%$K^n := \{(a_1, \ldots, a_n) | a_1, \ldots, a_n \in K \}$と定義する。 \\
%この時、多項式$f(x_1,\ldots,x_n)$の零点とは$K^n$の元$(a_1, \ldots, a_n)$で
%\begin{equation*}
%f(a_1, \ldots, a_n) = 0
%\end{equation*}
%を満たすものをいう(各$x_i$に$a_i$を代入している)。
%アフィン多様体は、連立方程式全ての零点を与える集合(つまり、連立方程式の解)であり、
%数式で書くと、以下のようになる:
%\begin{equation}
%V(f_1, \ldots, f_r) = \{(a_1, \ldots, a_n) | f_i(a_1, \ldots, a_n) = 0, i=1,\ldots,r\}.
%\end{equation}
%
%\end{frame}
%
%\begin{frame} {アフィン多様体の具体例}
%前節の難しかった連立方程式
%$f_1=x^2+y^2+4z^2-90(=0), f_2=x-y+z-12(=0), f_3=xz-3y-28(=0)$
%を解くことは、アフィン多様体を求めることであり、したがって$f_1,f_2,f_3$のアフィン多様体は
%\begin{equation*}
%V(f_1, f_2, f_3) = \Bigl\{
%\Bigl(\frac{7\pm\sqrt{3}}{2}, \frac{-13\pm3\sqrt{3}}{2}, 2\pm\sqrt{3} \Bigr),
%\Bigl(4\pm\sqrt{6}, \frac{-26\pm6\sqrt{6}}{5}, \frac{14\pm\sqrt{6}}{5} \Bigr)
%\Bigr\}
%\end{equation*}
%である。
%これを解く過程を見ることで、連立方程式を解くうえで、どういった演算ができる必要があるかを確認していく。
%\end{frame}
%
%\begin{frame}
%まず、$f_2=0$を$x$について解いて($x=y-z+12$)、$f_3=xz-3y-28$にそれを代入するということを行っていた:
%\begin{equation*}
%\left\{
%   \begin{aligned}
%   & f_1=x^2+y^2+4z^2-90=0 \\
%   & f_2=x-y+z-12=0 \\
%   & f_4=yz-3y-z^2+12z-28=0
%   \end{aligned}
%\right.
%\end{equation*}
%これは
%\begin{align*}
%f_4&=(y-z+12)z-3y-28 = (y-z+12)z -xz +xz -3y-28 \\
%& =(y-z+12-x)z+xz-3y-28=-zf_2+f_3
%\end{align*}
%となっていることから、$f_4=f_3-zf_2$であることが分かる。\\
%これがもとの連立方程式と同値なことは、$f_2=f_3=0$⇒$f_2=f_4=0$, $f_2=f_4=0$⇒$f_3=zf_2+f_4=0, f_2=0$であることより従う。
%\begin{block}{コメント}
%少し後に書いてあるが、代入操作というものは、
%$f_3$の$x$を$f_2-y+z-12$で置き換えて余りを$f_4$としていることに他ならない。
%\end{block}
%
%\end{frame}
%
%\begin{frame}
%次に$f_2=0$を$x$について解いて($x=y-z+12$)、$f_1=x^2+y^2+4z^2-90$に代入して、
%$f_4=0$を$yz$について解いたものを代入することで、
%\begin{equation*}
%\left\{
%   \begin{aligned}
%   & f_2=x-y+z-12=0 \\
%   & f_4=yz-3y-z^2+12z-28=0 \\
%   & f_5=2y^2+18y+3z^2-2=0
%   \end{aligned}
%\right.
%\end{equation*}
%を導いた。この$f_5$を導くための演算は
%\begin{equation*}
%f_1-(x+y-z+12)f_2+2f_4=f_5
%\end{equation*}
%となっていた。
%\end{frame}
%
%\begin{frame}
%さらにここから、$f_4$の$yz$と$f_5$の$2y^2$を打ち消すため、$2yf_4-zf_5$を作って、
%$f_4=0$を$yz$について解いた式と$f_5=0$を$y^2$について解いた式を代入し、最後に全体を$-1$倍することで、
%\begin{equation*}
%f_6=2y+5z^3-33z^2+54z+6=0
%\end{equation*}
%を得た。この$f_6$の求めるための演算を整理すれば、
%\begin{align*}
%& f_6=-1\times(2y f_4-z f_5+3 f_5+(2z-6) f_4+6 f_4) \\
%& = (-2y-2z)f_4+(z-3)f_5
%\end{align*}
%となる。$f_5$が不要かどうか自明でないため、ここでは一旦残しておいて、連立方程式を
%\begin{equation*}
%\left\{
%   \begin{aligned}
%   & f_2=x-y+z-12=0 \\
%   & f_4=yz-3y-z^2+12z-28=0 \\
%   & f_5=2y^2+18y+3z^2-2=0 \\
%   & f_6=2y+5z^3-33z^2+54z+6=0
%   \end{aligned}
%\right.
%\end{equation*}
%とする。
%\end{frame}
%
%\begin{frame}
%最後に
%\begin{align*}
%& f_7=-2f_4+(z-3)f_6=5z^4-48z^3+155z^2-180z+38 \\
%& f_8=2f_2+f_6=2x+5z^3-33z^2+56z-18
%\end{align*}
%として最終的な連立方程式を得ていた(前節で解いたときは$f_5$は消えていた)。
%\end{frame}
%
%\begin{frame} {イデアル}
%この連立方程式を求めるうえで、行った操作を振り返ると、
%代入やある項を打ち消す演算というのは、
%元々の多項式の多項式倍と、その足し合わせで定義されることが確認できた。
%そこで、もとの連立方程式を定義する多項式$f_1,\ldots,f_r$から、多項式倍の足し合わせにより得られるすべての多項式の集合に着目する:
%\begin{equation}
%\{h_1f_1 + \ldots + h_r f_r | h_1, \ldots, h_r \in K[x_1,\ldots,x_n] \} := \langle f_1, \ldots, f_r\rangle
%\end{equation}
%これまで求めた$f_4,f_5,f_6,f_7$は$\langle f_1, f_2, f_3\rangle$の元であることは確認出来て、例えば$f_7$は
%\end{frame}
%
%\begin{frame}
%\begin{align*}
%f_7 &= -2f_4+(z-3)f_6=-2f_4+(z-3)((-2y-2z)f_4+(z-3)f_5) \\
% &= (-2-(z-3)(2y+2z))f_4+(z-3)^2f_5 \\
% &= (-2-(z-3)(2y+2z))f_4+(z-3)^2(f_1-(x+y-z+12)f_2+2f_4) \\
% &= (-2+(z-3)(-2y-6))f_4+(z-3)^2f_1-(z-3)^2(x+y-z+12)f_2 \\
% &= (z-3)^2f_1+(2yz^2-6yz+6z^2-16z-(z-3)^2(x+y-12))f_2+(-2yz+6y-6z+16)f_3 \\
% &\in \langle f_1, f_2, f_3\rangle
%\end{align*}
%である(途中の式展開はちょっと怪しい。ただ、$f_1,f_2,f_3$の多項式倍の和であることは分かる加と思います)。
%\end{frame}
%
%\begin{frame}
%多項式の集合$\langle f_1,\ldots,f_r\rangle$は連立方程式$f_1=\cdots=f_r=0$を解くときの
%多項式倍と足し合わせの式変形により現れうる全ての多項式からなる集合である。 \\
%$\langle f_1,\ldots,f_r\rangle$は無限個の多項式を含むことがあるが、これが元の連立方程と同じ点を解の集合(アフィン多様体)を持つことを確認する: \\
%$\langle f_1,\ldots,f_r\rangle$のアフィン多様体を$V(\langle f_1,\ldots,f_r\rangle)$と書くことにする。
%この時$V(f_1,\ldots,f_r)=V(\langle f_1,\ldots,f_r\rangle)$であることを示す。 \\
%
%\begin{proof}
%$V(\langle f_1,\ldots,f_r\rangle) \subset V(f_1,\ldots,f_r)$を示す。 \\
%$a \in V(\langle f_1,\ldots,f_r\rangle)$ならば$\sum_r h_r(a) f_r(a) = 0$が任意の$h_r \in K[x_1,\ldots, x_n]$で成り立つ必要があるため、$f_1(a)=\cdots=f_r(a)=0$であることが分かる。\\
%
%次に$V(f_1,\ldots,f_r) \subset V(\langle f_1,\ldots,f_r\rangle)$を示す。\\
%$a \in V(f_1,\ldots,f_r)$ならば$f_1(a)=\cdots=f_r(a)=0$なので、$h_1(a)f_1(a)+\cdots+h_r(a)f_r(a)=0$が成り立つ。\\
%これは$a \in V\langle f_1,\ldots,f_r\rangle$であることを示しているため、
%$V(f_1,\ldots,f_r)=V(\langle f_1,\ldots,f_r\rangle)$であることが示された。
%\end{proof}
%
%\end{frame}
%
%\begin{frame}
%前ページの結果から、$\langle f_1,\ldots,f_r\rangle$のアフィン多様体を求めることで、元の連立方程式のアフィン多様体(連立方程式の解)が求まることが分かった。\\
%$\langle f_1,\ldots,f_r\rangle$は以下で定義する多項式環のイデアルの一つであり、
%連立方程式を求めるため、イデアルの性質を使うことができるため、$\langle f_1,\ldots,f_r\rangle$を主に考えていく:
%\begin{definition} [イデアル]
%多項式環の空でない部分集合$I \subset K[x_1,\ldots,x_n]$がイデアルとは、以下の2つの条件を満たすことである。
%\begin{enumerate}
%\item $f, g \in I \rightarrow f+g \in I$ (和について$I$の中で閉じている)
%\item $f \in I, h \in K[x_1,\ldots,x_n] \rightarrow hf \in I$ (多項式倍について$I$の中で閉じている)
%\end{enumerate}
%\end{definition}
%\begin{block} {コメント}
%$f, g \in I$の$-1 \in K[x_1,\ldots, x_n]$から$-1 \times g \in I$で、$f+(-g)=f-g \in I$である(差についても閉じていて、そういう前提で説明していく)
%\end{block}
%また、この定義は厳密には左イデアルと言う気がするがこの教科書ではイデアルと呼ぶ。
%\end{frame}
%
%\begin{frame} {イデアルの例}
%$I=\langle f_1,\ldots,f_r\rangle \subset K[x_1,\ldots,x_n]$がイデアルであることを、定義に従って確認する。\\
%$f, g \in \langle f_1,\ldots,f_r\rangle$とする。$f = \sum_{i=1}^r h_i f_i, g = \sum_{i=1}^r h'_i f_i$とすると、
%$f+g = \sum_{i=1}^r (h_i+h'_i) f_i$となり$f+g \in I$である。\\
%$f = f = \sum_{i=1}^r h_i f_i \in \langle f_1,\ldots,f_r\rangle, h \in K[x_1,\ldots,x_n]$とすると、
%$hf = \sum_{i=1}^r (h_i h) f_i$となり$hf \in I$である。\\
%したがって、$I$はイデアルである。
%\end{frame}


%\begin{frame} {有限生成なイデアル}
%前述のイデアルは、連立方程式の解を求めるためのものでだったため、
%\end{frame}

%\begin{frame}
%\end{frame}


% \section{セクションテンプレート}
% \begin{frame}{目次}
%     \tableofcontents[currentsection]
% \end{frame}
%
% \begin{frame}{ブロック環境}
%     \begin{block}{block}
%     block
%     \end{block}
%     \begin{alertblock}{alertblock}
%     alertblock
%     \end{alertblock}
%     \begin{exampleblock}{exampleblock}
%     exampleblock
%     \end{exampleblock}
%     \begin{tcolorbox}[colframe=green,
%     colback=green!10!white,
%     colbacktitle=green!40!white,
%     coltitle=black, fonttitle=\bfseries,
%     title=My box]
%         box contents
%     \end{tcolorbox}
% \end{frame}
%
%
% \begin{frame}{箇条書き}
%     \begin{itemize}
%     \item アイテム1
%     \item \alert{アイテム2}
%         \begin{itemize}
%         \item アイテム1
%         \item \alert{アイテム2}
%             \begin{itemize}
%             \item アイテム1
%             \item \alert{アイテム2}
%             \end{itemize}
%         \end{itemize}
%     \end{itemize}
%     \[
%     \bm{x}^\top\bm{y}
%     \]
%     \begin{enumerate}
%     \item abcde
%     \item \structure{ABCDE}
%     \item
%     \end{enumerate}
% \end{frame}

\end{document}
